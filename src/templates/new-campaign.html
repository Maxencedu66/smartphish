{% extends "index.html" %}

{% block title %}Nouvelle Campagne - SmartPhish{% endblock %}

{% block content %}

<div class="container mt-5">
    <h2 class="text-center mb-4">üì© Nouvelle Campagne</h2>

    <div class="card shadow-sm p-4">
        <form id="phishingForm">
            <div class="mb-3">
                <label for="scenario" class="form-label">Choisissez un sc√©nario :</label>
                <select id="scenario" name="scenario" class="form-select" onchange="updateFormFields()">
                    <option value="">-- S√©lectionnez --</option>
                    <option value="D√©part √† la retraite">D√©part √† la retraite</option>
                    <option value="Erreur de paiement - RIB n√©cessaire">Erreur de paiement - RIB n√©cessaire</option>
                    <option value="Alerte de s√©curit√© - Connexion suspecte">Alerte de s√©curit√© - Connexion suspecte</option>
                </select>
            </div>

            <div id="additionalFields" style="display: none;">
                <div class="mb-3">
                    <label for="entreprise" class="form-label">Nom de l'entreprise :</label>
                    <input type="text" id="entreprise" name="entreprise" class="form-control">
                </div>

                <div class="mb-3">
                    <label for="expediteur" class="form-label">Nom de l'exp√©diteur :</label>
                    <input type="text" id="expediteur" name="expediteur" class="form-control">
                </div>

                <div class="mb-3">
                    <label for="email_expediteur" class="form-label">Email exp√©diteur :</label>
                    <input type="email" id="email_expediteur" name="email_expediteur" class="form-control">
                </div>
            </div>

            <button type="button" class="btn btn-primary w-100 mt-3" onclick="generateEmail()">G√©n√©rer l'email</button>
        </form>
    </div>

    <div id="loading" class="text-center mt-4" style="display: none;">
        <p class="fw-bold">G√©n√©ration en cours...</p>
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>

    <div id="emailResult" class="card shadow-sm p-4 mt-4" style="display: none;">
        <h2 class="text-center">Email g√©n√©r√©</h2>
        <div class="mb-3">
            <textarea id="generatedEmailObject" rows="1" class="form-control" placeholder="Objet de l'email"></textarea>
        </div>
        <div class="mb-3">
            <textarea id="generatedEmailContent" rows="10" class="form-control" placeholder="Contenu de l'email"></textarea>
        </div>
        <div class="d-flex gap-2">
            <button class="btn btn-success flex-grow-1" onclick="lancement()">Valider</button>
            <button class="btn btn-warning flex-grow-1" onclick="generateEmail()">R√©g√©n√©rer</button>
            <button class="btn btn-danger flex-grow-1" onclick="resetForm()">üóë R√©initialiser</button>
        </div>
    </div>
</div>

{% endblock %}